---
output:
  md_document:
    variant: markdown_github
---

# Purpose

This is my Data Science 871 project , this README shows the method I used



```{r}

rm(list = ls()) # Clean your environment:
gc() # garbage collection - It can be useful to call gc after a large object has been removed, as this may prompt R to return memory to the operating system.
library(pacman)
p_load(tidyverse, lubridate)
list.files('code/', full.names = T, recursive = T) %>% .[grepl('.R', .)] %>% as.list() %>% walk(~source(.))
```

## Question 1 


```{r}

gc() # garbage collection - It can be useful to call gc after a large object has been removed, as this may prompt R to return memory to the operating system.
library(pacman)
p_load(tidyverse, lubridate)
library(tidytext)

list.files('Question1/code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))


Top_100_Billboard <- read_rds(here::here("Question1","data", "US_Baby_names", "charts.rds"))

Baby_Names <- read_rds(here::here("Question1","data", "US_Baby_names", "Baby_Names_By_US_State.rds"))

HBO_titles <-read_rds(here::here("Question1","data", "US_Baby_names","HBO_titles.rds"))

HBO_credits <- read_rds(here::here("Question1","data", "US_Baby_names","HBO_credits.rds"))

code_files <- list.files(here::here("Question1","code"), pattern = "\\.R$", full.names = TRUE)
invisible(lapply(code_files, source))


HBO_Bill_Names(data1= Baby_Names, data2 = Top_100_Billboard, data3 = HBO_credits)

most_common_hbo_names(data1=Baby_Names, data2 = Top_100_Billboard , data3= HBO_credits)

trend(data1 = Baby_Names , data2 = Top_100_Billboard , data3 = HBO_credits)

spear1(data = Baby_Names)



 print(
      xtable(
    get_spearman_for_year(data = Baby_Names, y = 1974, g = "F") %>%
      dplyr::mutate(
        Year = as.integer(Year),
        Future_Year = as.integer(Future_Year)
      ),
    caption = "Persistence of Female Names \\label{tab1}"
  ),
  include.rownames = FALSE,
  caption.placement = "bottom",
  comment = FALSE
)
 
 




```



## Question 2


```{r}


if(!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)


coldplay  <- read_csv(here::here("Question2","data", "Coldplay_vs_Metallica", "Coldplay.csv")) %>%  rename(album = `album_name`)
metallica <- read_csv(here::here("Question2","data", "Coldplay_vs_Metallica", "metallica.csv"))
spotify <- read_rds(here::here("Question2","data", "Coldplay_vs_Metallica", "Broader_Spotify_Info.rds"))
billboard_100 <- read_rds(here::here("Question2","data", "Coldplay_vs_Metallica", "charts.rds"))


code_files <- list.files(here::here("Question2","code"), pattern = "\\.R$", full.names = TRUE)
invisible(lapply(code_files, source))

plot_album_comparison(data1 = coldplay , data2 = metallica)
duration(data1 = coldplay, data2= metallica)
dannce_plot(data=coldplay, data2 = metallica)
danu(data = spotify)

```



## Question 3

```{r}


if(!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)
library(forcats)


Titles <- read_rds(here::here("Question3","data", "netflix", "titles.rds"))
Credit <- read_rds(here::here("Question3","data", "netflix", "credits.rds"))
Movie_Info <- read_csv(here::here("Question3","data", "netflix", "netflix_movies.csv"))

code_files <- list.files(here::here("Question3","code"), pattern = "\\.R$", full.names = TRUE)
invisible(lapply(code_files, source))

uno(data= Titles , top_n_genres =5, top_n_countries =5) 
trend(data = Titles)


```


#The chart a displays the highest-rated genre (by IMDb score) for five different production countries, focusing only on the top 5 most common genres across the data . The genre ['comedy', 'drama'] appears most frequently among the top-rated genres, suggesting that this hybrid genre resonates widely across different countries. Countries like India stand out by favoring documentaries, which may point to a niche strength or a particular audience taste.The consistently high IMDb scores across these genres indicate that when countries specialize or focus on these genres, the quality tends to be well-received by audiences.




## Question 4


```{r}


if(!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)
library(dplyr)
library(xtable)



Billions <- read_csv(here::here("Question4","data", "Billions","billionaires.csv")) %>% arrange(desc(company.founded)) 

code_files <- list.files(here::here("Question4", "code"), pattern = "\\.R$", full.names = TRUE)

invisible(lapply(code_files, source))


firstplot(data = Billions , Title = "Billionaires : Inherited Wealth ( USA vs Rest of World") 

third_plot(data = Billions , Title = "Top 10 Sectors Producing the Most Self- Made Billionaires Since 2000")


print(
  xtable(us_inheritance_table(data = Billions) , caption = "USA Billionaires by Inheritance Status \\label{tab1}"),
  include.rownames = FALSE,
  caption.placement = "bottom" , comment = FALSE ,
)


print(
  xtable(non_us_inheritance_table(data = Billions), caption = "Rest of the World by Inheritance Status\\label{tab2}"),
  include.rownames = FALSE,
  caption.placement = "bottom" , comment = FALSE 
)

print(
  xtable(top5_companies_table(data = Billions) , caption = "Companies With Most Billionaires \\label{tab3}"),
  include.rownames = FALSE,
  caption.placement = "bottom" , comment = FALSE ,
)







```




# Question 5 

```{r}



if(!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)

list.files('Question1/code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
list.files('Question2/code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
list.files('Question3/code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
list.files('Question4/code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
list.files('Question5/code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))



Health <- read_csv('/Users/tagishimashego/Desktop/Economics Masters/25179705/Question5/data/Health/HealthCare.csv')



```

